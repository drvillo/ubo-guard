{"location":"links/[id]/page.tsx:60","message":"API request start","data":{"id":"2izGCpmxEumD9rhOK2ToqHPHntQ5RY3AX6dtruaStX8","isUUID":false,"idLength":43},"timestamp":1766861813941,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"api/links/[id]/route.ts:19","message":"Parameter check","data":{"id":"2izGCpmxEumD9rhOK2ToqHPHntQ5RY3AX6dtruaStX8","isUUID":false,"idLength":43},"timestamp":1766861813960,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"B"}
{"location":"api/links/[id]/route.ts:91","message":"Token lookup path","data":{"hasUser":false},"timestamp":1766861813961,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"B"}
{"location":"api/links/[id]/route.ts:97","message":"Token hash lookup","data":{"tokenHashLength":64},"timestamp":1766861813962,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"B"}
{"location":"api/links/[id]/route.ts:121","message":"Token lookup result","data":{"found":true,"shareLinkId":"6650a620-3b1f-49ec-b3ea-49fc4c7e8419"},"timestamp":1766861814544,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"B"}
{"location":"links/[id]/page.tsx:66","message":"API response received","data":{"status":200,"ok":true},"timestamp":1766861814547,"sessionId":"debug-session","runId":"run1","hypothesisId":"E"}
{"location":"links/[id]/page.tsx:84","message":"Data parsed","data":{"hasId":true,"hasVendorLabel":true,"hasStatus":true,"hasDocuments":true,"docCount":1},"timestamp":1766861814558,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"links/[id]/page.tsx:87","message":"Link state set","data":{},"timestamp":1766861814565,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"links/[id]/page.tsx:96","message":"Finally block - loading set to false","data":{},"timestamp":1766861814571,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"links/[id]/page.tsx:60","message":"API request start","data":{"id":"2izGCpmxEumD9rhOK2ToqHPHntQ5RY3AX6dtruaStX8","isUUID":false,"idLength":43},"timestamp":1766861881018,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"api/links/[id]/route.ts:19","message":"Parameter check","data":{"id":"2izGCpmxEumD9rhOK2ToqHPHntQ5RY3AX6dtruaStX8","isUUID":false,"idLength":43},"timestamp":1766861881035,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"B"}
{"location":"api/links/[id]/route.ts:91","message":"Token lookup path","data":{"hasUser":false},"timestamp":1766861881037,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"B"}
{"location":"api/links/[id]/route.ts:97","message":"Token hash lookup","data":{"tokenHashLength":64},"timestamp":1766861881037,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"B"}
{"location":"api/links/[id]/route.ts:121","message":"Token lookup result","data":{"found":true,"shareLinkId":"6650a620-3b1f-49ec-b3ea-49fc4c7e8419"},"timestamp":1766861881553,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"B"}
{"location":"links/[id]/page.tsx:66","message":"API response received","data":{"status":200,"ok":true},"timestamp":1766861881556,"sessionId":"debug-session","runId":"run1","hypothesisId":"E"}
{"location":"links/[id]/page.tsx:84","message":"Data parsed","data":{"hasId":true,"hasVendorLabel":true,"hasStatus":true,"hasDocuments":true,"docCount":1},"timestamp":1766861881565,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"links/[id]/page.tsx:87","message":"Link state set","data":{},"timestamp":1766861881569,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"links/[id]/page.tsx:96","message":"Finally block - loading set to false","data":{},"timestamp":1766861881574,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"links/[id]/page.tsx:60","message":"API request start","data":{"id":"2izGCpmxEumD9rhOK2ToqHPHntQ5RY3AX6dtruaStX8","isUUID":false,"idLength":43},"timestamp":1766861888786,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"api/links/[id]/route.ts:19","message":"Parameter check","data":{"id":"2izGCpmxEumD9rhOK2ToqHPHntQ5RY3AX6dtruaStX8","isUUID":false,"idLength":43},"timestamp":1766861888800,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"B"}
{"location":"api/links/[id]/route.ts:91","message":"Token lookup path","data":{"hasUser":false},"timestamp":1766861888801,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"B"}
{"location":"api/links/[id]/route.ts:97","message":"Token hash lookup","data":{"tokenHashLength":64},"timestamp":1766861888801,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"B"}
{"location":"api/links/[id]/route.ts:121","message":"Token lookup result","data":{"found":true,"shareLinkId":"6650a620-3b1f-49ec-b3ea-49fc4c7e8419"},"timestamp":1766861889238,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"B"}
{"location":"links/[id]/page.tsx:66","message":"API response received","data":{"status":200,"ok":true},"timestamp":1766861889241,"sessionId":"debug-session","runId":"run1","hypothesisId":"E"}
{"location":"links/[id]/page.tsx:84","message":"Data parsed","data":{"hasId":true,"hasVendorLabel":true,"hasStatus":true,"hasDocuments":true,"docCount":1},"timestamp":1766861889254,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"links/[id]/page.tsx:87","message":"Link state set","data":{},"timestamp":1766861889260,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"links/[id]/page.tsx:96","message":"Finally block - loading set to false","data":{},"timestamp":1766861889266,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"links/[id]/page.tsx:60","message":"API request start","data":{"id":"2izGCpmxEumD9rhOK2ToqHPHntQ5RY3AX6dtruaStX8","isUUID":false,"idLength":43},"timestamp":1766861962105,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"api/links/[id]/route.ts:19","message":"Parameter check","data":{"id":"2izGCpmxEumD9rhOK2ToqHPHntQ5RY3AX6dtruaStX8","isUUID":false,"idLength":43},"timestamp":1766861962122,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"B"}
{"location":"api/links/[id]/route.ts:91","message":"Token lookup path","data":{"hasUser":false},"timestamp":1766861962123,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"B"}
{"location":"api/links/[id]/route.ts:97","message":"Token hash lookup","data":{"tokenHashLength":64},"timestamp":1766861962123,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"B"}
{"location":"api/links/[id]/route.ts:121","message":"Token lookup result","data":{"found":true,"shareLinkId":"6650a620-3b1f-49ec-b3ea-49fc4c7e8419"},"timestamp":1766861962588,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"B"}
{"location":"links/[id]/page.tsx:66","message":"API response received","data":{"status":200,"ok":true},"timestamp":1766861962591,"sessionId":"debug-session","runId":"run1","hypothesisId":"E"}
{"location":"links/[id]/page.tsx:84","message":"Data parsed","data":{"hasId":true,"hasVendorLabel":true,"hasStatus":true,"hasDocuments":true,"docCount":1},"timestamp":1766861962603,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"links/[id]/page.tsx:87","message":"Link state set","data":{},"timestamp":1766861962609,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"links/[id]/page.tsx:96","message":"Finally block - loading set to false","data":{},"timestamp":1766861962614,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"revoke/route.ts:34","message":"Access check result","data":{"userId":"adf7ef94-cb55-4274-bcf4-61e3d0b998de","vaultId":"4ea91cfe-dc7a-40ba-8a7c-988d2a635834","role":"delegate","createdById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257"},"timestamp":1767201099834,"sessionId":"debug-session","runId":"run1","hypothesisId":"E"}
{"location":"revoke/route.ts:40","message":"User profile lookup","data":{"userId":"adf7ef94-cb55-4274-bcf4-61e3d0b998de","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc","userProfileExists":true},"timestamp":1767201100126,"sessionId":"debug-session","runId":"run1","hypothesisId":"C"}
{"location":"revoke/route.ts:46","message":"Before delegate check","data":{"accessRole":"delegate","shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc","createdByIdType":"string","userProfileIdType":"string","idsMatch":false,"idsEqual":false},"timestamp":1767201100127,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"revoke/route.ts:47","message":"403 Unauthorized - delegate check failed","data":{"accessRole":"delegate","shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc","createdByIdIsNull":false,"createdByIdIsUndefined":false},"timestamp":1767201100128,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"revoke/route.ts:34","message":"Access check result","data":{"userId":"adf7ef94-cb55-4274-bcf4-61e3d0b998de","vaultId":"4ea91cfe-dc7a-40ba-8a7c-988d2a635834","role":"delegate","createdById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257"},"timestamp":1767201261457,"sessionId":"debug-session","runId":"run1","hypothesisId":"E"}
{"location":"revoke/route.ts:40","message":"User profile lookup","data":{"userId":"adf7ef94-cb55-4274-bcf4-61e3d0b998de","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc","userProfileExists":true},"timestamp":1767201261746,"sessionId":"debug-session","runId":"run1","hypothesisId":"C"}
{"location":"revoke/route.ts:46","message":"Before delegate check","data":{"accessRole":"delegate","shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc","createdByIdType":"string","userProfileIdType":"string","idsMatch":false,"idsEqual":false},"timestamp":1767201261748,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"revoke/route.ts:47","message":"403 Unauthorized - delegate check failed","data":{"accessRole":"delegate","shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc","createdByIdIsNull":false,"createdByIdIsUndefined":false},"timestamp":1767201261749,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"links/[id]/page.tsx:241","message":"Revoke button visibility check","data":{"status":"approved","willShow":false},"timestamp":1767201272923,"sessionId":"debug-session","runId":"post-fix"}
{"location":"links/[id]/page.tsx:241","message":"Revoke button visibility check","data":{"status":"approved","willShow":false},"timestamp":1767201272930,"sessionId":"debug-session","runId":"post-fix"}
{"location":"links/[id]/page.tsx:79","message":"Link data received","data":{"hasUserRole":false,"userRole":null,"hasCanRevoke":false,"linkId":"c23662f4-7802-4b65-ac4d-5c54096d0d16"},"timestamp":1767201326277,"sessionId":"debug-session","runId":"post-fix"}
{"location":"links/[id]/page.tsx:241","message":"Revoke button visibility check","data":{"status":"approved","willShow":false},"timestamp":1767201326292,"sessionId":"debug-session","runId":"post-fix"}
{"location":"links/[id]/page.tsx:241","message":"Revoke button visibility check","data":{"status":"approved","willShow":false},"timestamp":1767201326301,"sessionId":"debug-session","runId":"post-fix"}
{"location":"revoke/route.ts:34","message":"Access check result","data":{"userId":"adf7ef94-cb55-4274-bcf4-61e3d0b998de","vaultId":"4ea91cfe-dc7a-40ba-8a7c-988d2a635834","role":"delegate","createdById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257"},"timestamp":1767201347936,"sessionId":"debug-session","runId":"run1","hypothesisId":"E"}
{"location":"revoke/route.ts:40","message":"User profile lookup","data":{"userId":"adf7ef94-cb55-4274-bcf4-61e3d0b998de","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc","userProfileExists":true},"timestamp":1767201348223,"sessionId":"debug-session","runId":"run1","hypothesisId":"C"}
{"location":"revoke/route.ts:46","message":"Before delegate check","data":{"accessRole":"delegate","shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc","createdByIdType":"string","userProfileIdType":"string","idsMatch":false,"idsEqual":false},"timestamp":1767201348225,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"revoke/route.ts:47","message":"403 Unauthorized - delegate check failed","data":{"accessRole":"delegate","shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc","createdByIdIsNull":false,"createdByIdIsUndefined":false},"timestamp":1767201348226,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"links/[id]/page.tsx:79","message":"Link data received","data":{"hasUserRole":false,"userRole":null,"hasCanRevoke":false,"linkId":"c23662f4-7802-4b65-ac4d-5c54096d0d16"},"timestamp":1767201388108,"sessionId":"debug-session","runId":"post-fix"}
{"location":"links/[id]/page.tsx:241","message":"Revoke button visibility check","data":{"status":"approved","willShow":false},"timestamp":1767201388121,"sessionId":"debug-session","runId":"post-fix"}
{"location":"links/[id]/page.tsx:241","message":"Revoke button visibility check","data":{"status":"approved","willShow":false},"timestamp":1767201388128,"sessionId":"debug-session","runId":"post-fix"}
{"location":"links/[id]/route.ts:60","message":"Vault access check","data":{"userId":"adf7ef94-cb55-4274-bcf4-61e3d0b998de","vaultId":"4ea91cfe-dc7a-40ba-8a7c-988d2a635834","accessRole":"delegate","shareLinkId":"c23662f4-7802-4b65-ac4d-5c54096d0d16","shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257"},"timestamp":1767201393889,"sessionId":"debug-session","runId":"post-fix"}
{"location":"links/[id]/route.ts:60","message":"Vault access check","data":{"userId":"adf7ef94-cb55-4274-bcf4-61e3d0b998de","vaultId":"4ea91cfe-dc7a-40ba-8a7c-988d2a635834","accessRole":"delegate","shareLinkId":"c23662f4-7802-4b65-ac4d-5c54096d0d16","shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257"},"timestamp":1767201394054,"sessionId":"debug-session","runId":"post-fix"}
{"location":"links/[id]/route.ts:72","message":"Before delegate view check","data":{"accessRole":"delegate","shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc","idsMatch":false},"timestamp":1767201394134,"sessionId":"debug-session","runId":"post-fix"}
{"location":"links/[id]/route.ts:73","message":"403 - Delegate cannot view this link","data":{"accessRole":"delegate","shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc"},"timestamp":1767201394137,"sessionId":"debug-session","runId":"post-fix"}
{"location":"links/[id]/route.ts:72","message":"Before delegate view check","data":{"accessRole":"delegate","shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc","idsMatch":false},"timestamp":1767201394336,"sessionId":"debug-session","runId":"post-fix"}
{"location":"links/[id]/route.ts:73","message":"403 - Delegate cannot view this link","data":{"accessRole":"delegate","shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc"},"timestamp":1767201394337,"sessionId":"debug-session","runId":"post-fix"}
{"location":"links/[id]/route.ts:60","message":"Vault access check","data":{"userId":"adf7ef94-cb55-4274-bcf4-61e3d0b998de","vaultId":"4ea91cfe-dc7a-40ba-8a7c-988d2a635834","accessRole":"delegate","shareLinkId":"c23662f4-7802-4b65-ac4d-5c54096d0d16","shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257"},"timestamp":1767201415411,"sessionId":"debug-session","runId":"post-fix"}
{"location":"links/[id]/route.ts:60","message":"Vault access check","data":{"userId":"adf7ef94-cb55-4274-bcf4-61e3d0b998de","vaultId":"4ea91cfe-dc7a-40ba-8a7c-988d2a635834","accessRole":"delegate","shareLinkId":"c23662f4-7802-4b65-ac4d-5c54096d0d16","shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257"},"timestamp":1767201415559,"sessionId":"debug-session","runId":"post-fix"}
{"location":"links/[id]/route.ts:72","message":"Before delegate view check","data":{"accessRole":"delegate","shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc","idsMatch":false},"timestamp":1767201415654,"sessionId":"debug-session","runId":"post-fix"}
{"location":"links/[id]/route.ts:73","message":"403 - Delegate cannot view this link","data":{"accessRole":"delegate","shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc"},"timestamp":1767201415655,"sessionId":"debug-session","runId":"post-fix"}
{"location":"links/[id]/route.ts:72","message":"Before delegate view check","data":{"accessRole":"delegate","shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc","idsMatch":false},"timestamp":1767201415838,"sessionId":"debug-session","runId":"post-fix"}
{"location":"links/[id]/route.ts:73","message":"403 - Delegate cannot view this link","data":{"accessRole":"delegate","shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc"},"timestamp":1767201415839,"sessionId":"debug-session","runId":"post-fix"}
{"location":"links/[id]/page.tsx:241","message":"Revoke button visibility check","data":{"status":"approved","willShow":false},"timestamp":1767201639818,"sessionId":"debug-session","runId":"post-fix"}
{"location":"links/[id]/page.tsx:241","message":"Revoke button visibility check","data":{"status":"approved","willShow":false},"timestamp":1767201639825,"sessionId":"debug-session","runId":"post-fix"}
{"location":"links/[id]/route.ts:80","message":"Delegate view check","data":{"shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc","shareRequestCreatedById":"0aa0e883-29a7-4297-8fad-d425a0e026fc","hasShareRequest":true,"canView":true},"timestamp":1767201780742,"sessionId":"debug-session","runId":"run1"}
{"location":"links/[id]/route.ts:80","message":"Delegate view check","data":{"shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc","shareRequestCreatedById":"0aa0e883-29a7-4297-8fad-d425a0e026fc","hasShareRequest":true,"canView":true},"timestamp":1767201780763,"sessionId":"debug-session","runId":"run1"}
{"location":"links/[id]/page.tsx:66","message":"Load link API response","data":{"status":200,"ok":true,"linkId":"c23662f4-7802-4b65-ac4d-5c54096d0d16"},"timestamp":1767201780755,"sessionId":"debug-session","runId":"run1"}
{"location":"links/[id]/page.tsx:66","message":"Load link API response","data":{"status":200,"ok":true,"linkId":"c23662f4-7802-4b65-ac4d-5c54096d0d16"},"timestamp":1767201780768,"sessionId":"debug-session","runId":"run1"}
{"location":"links/[id]/route.ts:80","message":"Delegate view check","data":{"shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc","shareRequestCreatedById":"0aa0e883-29a7-4297-8fad-d425a0e026fc","hasShareRequest":true,"canView":true},"timestamp":1767201905701,"sessionId":"debug-session","runId":"run1"}
{"location":"links/[id]/page.tsx:66","message":"Load link API response","data":{"status":200,"ok":true,"linkId":"c23662f4-7802-4b65-ac4d-5c54096d0d16"},"timestamp":1767201905706,"sessionId":"debug-session","runId":"run1"}
{"location":"revoke/route.ts:48","message":"Delegate revoke check","data":{"shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc","shareRequestCreatedById":"0aa0e883-29a7-4297-8fad-d425a0e026fc","hasShareRequest":true,"canRevoke":true},"timestamp":1767201909164,"sessionId":"debug-session","runId":"run1"}
{"location":"links/[id]/route.ts:80","message":"Delegate view check","data":{"shareLinkCreatedById":"e065551c-53bf-4c7f-85d5-9b7c6d73b257","userProfileId":"0aa0e883-29a7-4297-8fad-d425a0e026fc","shareRequestCreatedById":"0aa0e883-29a7-4297-8fad-d425a0e026fc","hasShareRequest":true,"canView":true},"timestamp":1767201911210,"sessionId":"debug-session","runId":"run1"}
{"location":"links/[id]/page.tsx:66","message":"Load link API response","data":{"status":200,"ok":true,"linkId":"c23662f4-7802-4b65-ac4d-5c54096d0d16"},"timestamp":1767201911217,"sessionId":"debug-session","runId":"run1"}
{"location":"links/[id]/page.tsx:38","message":"Links page - id received","data":{"id":"tCQCcVkXTgZsf6E-XtcCIWOO--G0dQoVLnHk30AFcp4","pathname":"/links/tCQCcVkXTgZsf6E-XtcCIWOO--G0dQoVLnHk30AFcp4","isVendorToken":true},"timestamp":1767263218933,"sessionId":"debug-session","runId":"pre-fix","hypothesisId":"C"}
{"location":"links/[id]/page.tsx:45","message":"Links page - loading link","data":{"id":"tCQCcVkXTgZsf6E-XtcCIWOO--G0dQoVLnHk30AFcp4","apiEndpoint":"/api/links/tCQCcVkXTgZsf6E-XtcCIWOO--G0dQoVLnHk30AFcp4"},"timestamp":1767263218938,"sessionId":"debug-session","runId":"pre-fix","hypothesisId":"C"}
{"location":"links/[id]/page.tsx:61","message":"Links page - link loaded","data":{"id":"tCQCcVkXTgZsf6E-XtcCIWOO--G0dQoVLnHk30AFcp4","linkId":"c591509e-e479-45bc-98a5-6d650a9c0495","status":"approved"},"timestamp":1767263219972,"sessionId":"debug-session","runId":"pre-fix","hypothesisId":"C"}
{"location":"approve/route.ts:179","message":"URL generation - before fix","data":{"appUrl":"http://localhost:3000","linkToken":"6MyWFOFJteoPiY4idPb3wmOLhvNZm7Lujsaoklsn1YM","oldUrl":"http://localhost:3000/links/6MyWFOFJteoPiY4idPb3wmOLhvNZm7Lujsaoklsn1YM","newUrl":"http://localhost:3000/v/6MyWFOFJteoPiY4idPb3wmOLhvNZm7Lujsaoklsn1YM"},"timestamp":1767263327107,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"A"}
{"location":"approve/route.ts:181","message":"URL generation - after fix","data":{"linkUrl":"http://localhost:3000/v/6MyWFOFJteoPiY4idPb3wmOLhvNZm7Lujsaoklsn1YM","isCorrectPath":true},"timestamp":1767263327111,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"A"}
{"location":"v/[token]/page.tsx:34","message":"Vendor page - token received","data":{"token":"6MyWFOFJteoPiY4idPb3wmOLhvNZm7Lujsaoklsn1YM","pathname":"/v/6MyWFOFJteoPiY4idPb3wmOLhvNZm7Lujsaoklsn1YM"},"timestamp":1767263342804,"sessionId":"debug-session","runId":"pre-fix","hypothesisId":"B"}
{"location":"approve/route.ts:139","message":"Approve route - token generated and hashed","data":{"linkToken":"IObjmI9t7WYRHYRisP0wdmTlmIkmRwGPUj-Aj43Hcs0","tokenHash":"73c955a3833a4614e508da7e825fdb1695895e807e73fae08a456daaed2de7b3","tokenLength":43,"tokenHashLength":64},"timestamp":1767263462848,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"G"}
{"location":"approve/route.ts:160","message":"Approve route - share link created","data":{"linkToken":"IObjmI9t7WYRHYRisP0wdmTlmIkmRwGPUj-Aj43Hcs0","tokenHash":"73c955a3833a4614e508da7e825fdb1695895e807e73fae08a456daaed2de7b3","shareLinkId":"f60e7fd5-78f7-4c52-a100-673714802c89","storedTokenHash":"73c955a3833a4614e508da7e825fdb1695895e807e73fae08a456daaed2de7b3"},"timestamp":1767263463129,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"G"}
{"location":"approve/route.ts:179","message":"URL generation - before fix","data":{"appUrl":"http://localhost:3000","linkToken":"IObjmI9t7WYRHYRisP0wdmTlmIkmRwGPUj-Aj43Hcs0","oldUrl":"http://localhost:3000/links/IObjmI9t7WYRHYRisP0wdmTlmIkmRwGPUj-Aj43Hcs0","newUrl":"http://localhost:3000/v/IObjmI9t7WYRHYRisP0wdmTlmIkmRwGPUj-Aj43Hcs0"},"timestamp":1767263463690,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"A"}
{"location":"approve/route.ts:181","message":"URL generation - after fix","data":{"linkUrl":"http://localhost:3000/v/IObjmI9t7WYRHYRisP0wdmTlmIkmRwGPUj-Aj43Hcs0","isCorrectPath":true},"timestamp":1767263463692,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"A"}
{"location":"v/[token]/page.tsx:34","message":"Vendor page - token received","data":{"token":"IObjmI9t7WYRHYRisP0wdmTlmIkmRwGPUj-Aj43Hcs0","pathname":"/v/IObjmI9t7WYRHYRisP0wdmTlmIkmRwGPUj-Aj43Hcs0"},"timestamp":1767263474378,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"B"}
{"location":"v/[token]/page.tsx:45","message":"Vendor page - fetching link info","data":{"token":"IObjmI9t7WYRHYRisP0wdmTlmIkmRwGPUj-Aj43Hcs0","apiEndpoint":"/api/vendor/IObjmI9t7WYRHYRisP0wdmTlmIkmRwGPUj-Aj43Hcs0/link-info"},"timestamp":1767263474382,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"D"}
{"location":"vendor/[token]/link-info/route.ts:10","message":"Vendor link-info - token received","data":{"token":"IObjmI9t7WYRHYRisP0wdmTlmIkmRwGPUj-Aj43Hcs0","tokenLength":43},"timestamp":1767263474425,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"F"}
{"location":"vendor/[token]/link-info/route.ts:13","message":"Vendor link-info - token hash computed","data":{"token":"IObjmI9t7WYRHYRisP0wdmTlmIkmRwGPUj-Aj43Hcs0","tokenHash":"73c955a3833a4614e508da7e825fdb1695895e807e73fae08a456daaed2de7b3","tokenHashLength":64},"timestamp":1767263474425,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"F"}
{"location":"v/[token]/page.tsx:48","message":"Vendor page - API error","data":{"token":"IObjmI9t7WYRHYRisP0wdmTlmIkmRwGPUj-Aj43Hcs0","status":500,"statusText":"Internal Server Error"},"timestamp":1767263474476,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"D"}
{"location":"v/[token]/page.tsx:75","message":"Vendor page - error loading link info","data":{"token":"IObjmI9t7WYRHYRisP0wdmTlmIkmRwGPUj-Aj43Hcs0","error":"Internal server error"},"timestamp":1767263474481,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"D"}
{"location":"approve/route.ts:139","message":"Approve route - token generated and hashed","data":{"linkToken":"8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4","tokenHash":"4d18355b57c3c949c337abcd482614e2ca55868076b85867b25fedb0b2191e07","tokenLength":43,"tokenHashLength":64},"timestamp":1767263606574,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"G"}
{"location":"approve/route.ts:160","message":"Approve route - share link created","data":{"linkToken":"8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4","tokenHash":"4d18355b57c3c949c337abcd482614e2ca55868076b85867b25fedb0b2191e07","shareLinkId":"614c8284-c8a3-41b5-92c0-cc12f2530744","storedTokenHash":"4d18355b57c3c949c337abcd482614e2ca55868076b85867b25fedb0b2191e07"},"timestamp":1767263606862,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"G"}
{"location":"approve/route.ts:179","message":"URL generation - before fix","data":{"appUrl":"http://localhost:3000","linkToken":"8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4","oldUrl":"http://localhost:3000/links/8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4","newUrl":"http://localhost:3000/v/8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4"},"timestamp":1767263607445,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"A"}
{"location":"approve/route.ts:181","message":"URL generation - after fix","data":{"linkUrl":"http://localhost:3000/v/8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4","isCorrectPath":true},"timestamp":1767263607449,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"A"}
{"location":"v/[token]/page.tsx:34","message":"Vendor page - token received","data":{"token":"8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4","pathname":"/v/8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4"},"timestamp":1767263629694,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"B"}
{"location":"v/[token]/page.tsx:45","message":"Vendor page - fetching link info","data":{"token":"8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4","apiEndpoint":"/api/vendor/8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4/link-info"},"timestamp":1767263629698,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"D"}
{"location":"vendor/[token]/link-info/route.ts:10","message":"Vendor link-info - token received","data":{"token":"8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4","tokenLength":43},"timestamp":1767263629738,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"F"}
{"location":"vendor/[token]/link-info/route.ts:13","message":"Vendor link-info - token hash computed","data":{"token":"8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4","tokenHash":"4d18355b57c3c949c337abcd482614e2ca55868076b85867b25fedb0b2191e07","tokenHashLength":64},"timestamp":1767263629738,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"F"}
{"location":"v/[token]/page.tsx:48","message":"Vendor page - API error","data":{"token":"8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4","status":500,"statusText":"Internal Server Error"},"timestamp":1767263629840,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"D"}
{"location":"v/[token]/page.tsx:75","message":"Vendor page - error loading link info","data":{"token":"8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4","error":"Internal server error"},"timestamp":1767263629845,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"D"}
{"location":"v/[token]/page.tsx:34","message":"Vendor page - token received","data":{"token":"8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4","pathname":"/v/8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4"},"timestamp":1767263723497,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"B"}
{"location":"v/[token]/page.tsx:45","message":"Vendor page - fetching link info","data":{"token":"8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4","apiEndpoint":"/api/vendor/8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4/link-info"},"timestamp":1767263723502,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"D"}
{"location":"vendor/[token]/link-info/route.ts:10","message":"Vendor link-info - token received","data":{"token":"8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4","tokenLength":43},"timestamp":1767263723535,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"F"}
{"location":"vendor/[token]/link-info/route.ts:13","message":"Vendor link-info - token hash computed","data":{"token":"8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4","tokenHash":"4d18355b57c3c949c337abcd482614e2ca55868076b85867b25fedb0b2191e07","tokenHashLength":64},"timestamp":1767263723535,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"F"}
{"location":"vendor/[token]/link-info/route.ts:84","message":"Vendor link-info - ERROR CAUGHT","data":{"errorMessage":"\nInvalid `__TURBOPACK__imported__module__$5b$project$5d2f$opt$2f$ubo$2d$guard$2f$webapp$2f$src$2f$lib$2f$db$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__[\"prisma\"].shareLink.findUnique()` invocation in\n/Users/fvivoli/opt/ubo-guard/webapp/.next/dev/server/chunks/[root-of-the-server]__c8938b7b._.js:163:211\n\n  160     hypothesisId: 'F'\n  161 });\n  162 // #endregion\n→ 163 const shareLink = await __TURBOPACK__imported__module__$5b$project$5d2f$opt$2f$ubo$2d$guard$2f$webapp$2f$src$2f$lib$2f$db$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__[\"prisma\"].shareLink.findUnique({\n        where: {\n          tokenHash: \"4d18355b57c3c949c337abcd482614e2ca55868076b85867b25fedb0b2191e07\",\n      ?   id?: String,\n      ?   shareRequestId?: String,\n      ?   AND?: ShareLinkWhereInput | ShareLinkWhereInput[],\n      ?   OR?: ShareLinkWhereInput[],\n      ?   NOT?: ShareLinkWhereInput | ShareLinkWhereInput[],\n      ?   vaultId?: StringFilter | String,\n      ?   createdById?: StringFilter | String,\n      ?   status?: EnumShareLinkStatusFilter | ShareLinkStatus,\n      ?   approvedById?: StringNullableFilter | String | Null,\n      ?   approvedAt?: DateTimeNullableFilter | DateTime | Null,\n      ?   vendorLabel?: StringFilter | String,\n      ?   vendorEmail?: StringFilter | String,\n      ?   purposeNotes?: StringNullableFilter | String | Null,\n      ?   expiresAt?: DateTimeFilter | DateTime,\n      ?   revokedAt?: DateTimeNullableFilter | DateTime | Null,\n      ?   encryptedLskForVendor?: StringNullableFilter | String | Null,\n      ?   lskSalt?: StringNullableFilter | String | Null,\n      ?   lskNonce?: StringNullableFilter | String | Null,\n      ?   createdAt?: DateTimeFilter | DateTime,\n      ?   updatedAt?: DateTimeFilter | DateTime,\n      ?   vault?: VaultRelationFilter | VaultWhereInput,\n      ?   creator?: UserProfileRelationFilter | UserProfileWhereInput,\n      ?   approver?: UserProfileNullableRelationFilter | UserProfileWhereInput | Null,\n      ?   shareRequest?: ShareRequestNullableRelationFilter | ShareRequestWhereInput | Null,\n      ?   documents?: ShareLinkDocumentListRelationFilter,\n      ?   auditEvents?: AuditEventListRelationFilter,\n      ?   otpChallenges?: OtpChallengeListRelationFilter\n        },\n        select: {\n          id: true,\n          vaultId: true,\n          vendorLabel: true,\n          purposeNotes: true,\n          status: true,\n          expiresAt: true,\n          revokedAt: true,\n          approvedAt: true,\n          createdAt: true,\n          encryptedLskForVendor: true,\n          lskSalt: true,\n          lskNonce: true\n        }\n      })\n\nArgument `where` of type ShareLinkWhereUniqueInput needs at least one of `id` or `shareRequestId` arguments. Available options are marked with ?.","errorStack":"PrismaClientValidationError: \nInvalid `__TURBOPACK__imported__module__$5b$project$5d2f$opt$2f$ubo$2d$guard$2f$webapp$2f$src$2f$lib$2f$db$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__[\"prisma\"].shareLink.findUnique()` invocation in\n/Users/fvivoli/opt/ubo-guard/webapp/.next/dev/server/chunks/[root-of-the-server]__c8938b7b._.js:163:211\n\n  160     hypothesisId: 'F'\n  161 });\n  162 // #endregion\n→ 163 const shareLink = await __TURBOPACK__imported__module__$5b$project$5d2f$opt$2f$ubo$2d$guard$2f$webapp$2f$src$2f$lib$2f$db$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__[\"prisma\"].shareLink.findUnique({\n        where: {\n          tokenHash: \"4d18355b57c3c949c337abcd482614e2ca55868076b85867b25fedb0b2191e07\",\n      ?   id?: String,\n      ?   shareRequestId?: String,\n      ?   AND?: ShareLinkWhereInput | ShareLinkWhereInput[],\n      ?   OR?: ShareLinkWhereInput[],\n      ?   NOT?: ShareLinkWhereInput | ShareLinkWhereInput[],\n      ?   vaultId?: StringFilter | String,\n      ?   createdById?: StringFilter | String,\n      ?   status?: EnumShareLinkStatusFilter | ShareLinkStatus,\n      ?   approvedById?: StringNullableFilter | String | Null,\n      ?   approvedAt?: DateTimeNullableFilter | DateTime | Null,\n      ?   vendorLabel?: StringFilter | String,\n      ?   vendorEmail?: StringFilter | String,\n      ?   purposeNotes?: StringNullableFilter | String | Null,\n      ?   expiresAt?: DateTimeFilter | DateTime,\n      ?   revokedAt?: DateTimeNullableFilter | DateTime | Null,\n      ?   encryptedLskForVendor?: StringNullableFilter | String | Null,\n      ?   lskSalt?: StringNullableFilter | String | Null,\n      ?   lskNonce?: StringNullableFilter | String | Null,\n      ?   createdAt?: DateTimeFilter | DateTime,\n      ?   updatedAt?: DateTimeFilter | DateTime,\n      ?   vault?: VaultRelationFilter | VaultWhereInput,\n      ?   creator?: UserProfileRelationFilter | UserProfileWhereInput,\n      ?   approver?: UserProfileNullableRelationFilter | UserProfileWhereInput | Null,\n      ?   shareRequest?: ShareRequestNullableRelationFilter | ShareRequestWhereInput | Null,\n      ?   documents?: ShareLinkDocumentListRelationFilter,\n      ?   auditEvents?: AuditEventListRelationFilter,\n      ?   otpChallenges?: OtpChallengeListRelationFilter\n        },\n        select: {\n          id: true,\n          vaultId: true,\n          vendorLabel: true,\n          purposeNotes: true,\n          status: true,\n          expiresAt: true,\n          revokedAt: true,\n          approvedAt: true,\n          createdAt: true,\n          encryptedLskForVendor: true,\n          lskSalt: true,\n          lskNonce: true\n        }\n      })\n\nArgument `where` of type ShareLinkWhereUniqueInput needs at least one of `id` or `shareRequestId` arguments. Available options are marked with ?.\n    at wn (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/@prisma+client@5.22.0_prisma@5.22.0/node_modules/@prisma/client/runtime/library.js:29:1363)\n    at $n.handleRequestError (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/@prisma+client@5.22.0_prisma@5.22.0/node_modules/@prisma/client/runtime/library.js:121:6958)\n    at $n.handleAndLogRequestError (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/@prisma+client@5.22.0_prisma@5.22.0/node_modules/@prisma/client/runtime/library.js:121:6623)\n    at $n.request (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/@prisma+client@5.22.0_prisma@5.22.0/node_modules/@prisma/client/runtime/library.js:121:6307)\n    at async l (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/@prisma+client@5.22.0_prisma@5.22.0/node_modules/@prisma/client/runtime/library.js:130:9633)\n    at async GET (/Users/fvivoli/opt/ubo-guard/webapp/.next/dev/server/chunks/[root-of-the-server]__c8938b7b._.js:163:27)\n    at async AppRouteRouteModule.do (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js:5:37866)\n    at async AppRouteRouteModule.handle (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js:5:45156)\n    at async responseGenerator (/Users/fvivoli/opt/ubo-guard/webapp/.next/dev/server/chunks/[root-of-the-server]__3a8594ea._.js:14849:38)\n    at async AppRouteRouteModule.handleResponse (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js:1:187713)\n    at async handleResponse (/Users/fvivoli/opt/ubo-guard/webapp/.next/dev/server/chunks/[root-of-the-server]__3a8594ea._.js:14912:32)\n    at async Module.handler (/Users/fvivoli/opt/ubo-guard/webapp/.next/dev/server/chunks/[root-of-the-server]__3a8594ea._.js:14965:13)\n    at async DevServer.renderToResponseWithComponentsImpl (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/base-server.js:1422:9)\n    at async DevServer.renderPageComponent (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/base-server.js:1474:24)\n    at async DevServer.renderToResponseImpl (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/base-server.js:1524:32)\n    at async DevServer.pipeImpl (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/base-server.js:1018:25)\n    at async NextNodeServer.handleCatchallRenderRequest (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/next-server.js:395:17)\n    at async DevServer.handleRequestImpl (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/base-server.js:909:17)\n    at async /Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/dev/next-dev-server.js:387:20\n    at async Span.traceAsyncFn (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/trace/trace.js:157:20)\n    at async DevServer.handleRequest (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/dev/next-dev-server.js:383:24)\n    at async invokeRender (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/lib/router-server.js:248:21)\n    at async handleRequest (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/lib/router-server.js:447:24)\n    at async requestHandlerImpl (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/lib/router-server.js:496:13)\n    at async Server.requestListener (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/lib/start-server.js:226:13)","errorName":"PrismaClientValidationError"},"timestamp":1767263723583,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"H"}
{"location":"v/[token]/page.tsx:48","message":"Vendor page - API error","data":{"token":"8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4","status":500,"statusText":"Internal Server Error"},"timestamp":1767263723627,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"D"}
{"location":"v/[token]/page.tsx:75","message":"Vendor page - error loading link info","data":{"token":"8fgEUauxogMoihBt0TrRG0e81y31Vn7snNCkrI-yBp4","error":"Internal server error"},"timestamp":1767263723632,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"D"}
{"location":"approve/route.ts:139","message":"Approve route - token generated and hashed","data":{"linkToken":"99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4","tokenHash":"270cff701edb2674b0c68b01f081ddd1d9b1a064fad595cddf948b51f9920dfd","tokenLength":43,"tokenHashLength":64},"timestamp":1767265560469,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"G"}
{"location":"approve/route.ts:160","message":"Approve route - share link created","data":{"linkToken":"99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4","tokenHash":"270cff701edb2674b0c68b01f081ddd1d9b1a064fad595cddf948b51f9920dfd","shareLinkId":"ec8f0fa6-8515-498e-a6f5-a7ed671b09b9","storedTokenHash":"270cff701edb2674b0c68b01f081ddd1d9b1a064fad595cddf948b51f9920dfd"},"timestamp":1767265560770,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"G"}
{"location":"approve/route.ts:179","message":"URL generation - before fix","data":{"appUrl":"http://localhost:3000","linkToken":"99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4","oldUrl":"http://localhost:3000/links/99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4","newUrl":"http://localhost:3000/v/99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4"},"timestamp":1767265561352,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"A"}
{"location":"approve/route.ts:181","message":"URL generation - after fix","data":{"linkUrl":"http://localhost:3000/v/99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4","isCorrectPath":true},"timestamp":1767265561354,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"A"}
{"location":"v/[token]/page.tsx:34","message":"Vendor page - token received","data":{"token":"99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4","pathname":"/v/99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4"},"timestamp":1767265579935,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"B"}
{"location":"v/[token]/page.tsx:45","message":"Vendor page - fetching link info","data":{"token":"99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4","apiEndpoint":"/api/vendor/99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4/link-info"},"timestamp":1767265579940,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"D"}
{"location":"vendor/[token]/link-info/route.ts:10","message":"Vendor link-info - token received","data":{"token":"99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4","tokenLength":43},"timestamp":1767265579990,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"F"}
{"location":"vendor/[token]/link-info/route.ts:13","message":"Vendor link-info - token hash computed","data":{"token":"99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4","tokenHash":"270cff701edb2674b0c68b01f081ddd1d9b1a064fad595cddf948b51f9920dfd","tokenHashLength":64},"timestamp":1767265579991,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"F"}
{"location":"vendor/[token]/link-info/route.ts:84","message":"Vendor link-info - ERROR CAUGHT","data":{"errorMessage":"\nInvalid `__TURBOPACK__imported__module__$5b$project$5d2f$opt$2f$ubo$2d$guard$2f$webapp$2f$src$2f$lib$2f$db$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__[\"prisma\"].shareLink.findUnique()` invocation in\n/Users/fvivoli/opt/ubo-guard/webapp/.next/dev/server/chunks/[root-of-the-server]__c8938b7b._.js:163:211\n\n  160     hypothesisId: 'F'\n  161 });\n  162 // #endregion\n→ 163 const shareLink = await __TURBOPACK__imported__module__$5b$project$5d2f$opt$2f$ubo$2d$guard$2f$webapp$2f$src$2f$lib$2f$db$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__[\"prisma\"].shareLink.findUnique({\n        where: {\n          tokenHash: \"270cff701edb2674b0c68b01f081ddd1d9b1a064fad595cddf948b51f9920dfd\",\n      ?   id?: String,\n      ?   shareRequestId?: String,\n      ?   AND?: ShareLinkWhereInput | ShareLinkWhereInput[],\n      ?   OR?: ShareLinkWhereInput[],\n      ?   NOT?: ShareLinkWhereInput | ShareLinkWhereInput[],\n      ?   vaultId?: StringFilter | String,\n      ?   createdById?: StringFilter | String,\n      ?   status?: EnumShareLinkStatusFilter | ShareLinkStatus,\n      ?   approvedById?: StringNullableFilter | String | Null,\n      ?   approvedAt?: DateTimeNullableFilter | DateTime | Null,\n      ?   vendorLabel?: StringFilter | String,\n      ?   vendorEmail?: StringFilter | String,\n      ?   purposeNotes?: StringNullableFilter | String | Null,\n      ?   expiresAt?: DateTimeFilter | DateTime,\n      ?   revokedAt?: DateTimeNullableFilter | DateTime | Null,\n      ?   encryptedLskForVendor?: StringNullableFilter | String | Null,\n      ?   lskSalt?: StringNullableFilter | String | Null,\n      ?   lskNonce?: StringNullableFilter | String | Null,\n      ?   createdAt?: DateTimeFilter | DateTime,\n      ?   updatedAt?: DateTimeFilter | DateTime,\n      ?   vault?: VaultRelationFilter | VaultWhereInput,\n      ?   creator?: UserProfileRelationFilter | UserProfileWhereInput,\n      ?   approver?: UserProfileNullableRelationFilter | UserProfileWhereInput | Null,\n      ?   shareRequest?: ShareRequestNullableRelationFilter | ShareRequestWhereInput | Null,\n      ?   documents?: ShareLinkDocumentListRelationFilter,\n      ?   auditEvents?: AuditEventListRelationFilter,\n      ?   otpChallenges?: OtpChallengeListRelationFilter\n        },\n        select: {\n          id: true,\n          vaultId: true,\n          vendorLabel: true,\n          purposeNotes: true,\n          status: true,\n          expiresAt: true,\n          revokedAt: true,\n          approvedAt: true,\n          createdAt: true,\n          encryptedLskForVendor: true,\n          lskSalt: true,\n          lskNonce: true\n        }\n      })\n\nArgument `where` of type ShareLinkWhereUniqueInput needs at least one of `id` or `shareRequestId` arguments. Available options are marked with ?.","errorStack":"PrismaClientValidationError: \nInvalid `__TURBOPACK__imported__module__$5b$project$5d2f$opt$2f$ubo$2d$guard$2f$webapp$2f$src$2f$lib$2f$db$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__[\"prisma\"].shareLink.findUnique()` invocation in\n/Users/fvivoli/opt/ubo-guard/webapp/.next/dev/server/chunks/[root-of-the-server]__c8938b7b._.js:163:211\n\n  160     hypothesisId: 'F'\n  161 });\n  162 // #endregion\n→ 163 const shareLink = await __TURBOPACK__imported__module__$5b$project$5d2f$opt$2f$ubo$2d$guard$2f$webapp$2f$src$2f$lib$2f$db$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__[\"prisma\"].shareLink.findUnique({\n        where: {\n          tokenHash: \"270cff701edb2674b0c68b01f081ddd1d9b1a064fad595cddf948b51f9920dfd\",\n      ?   id?: String,\n      ?   shareRequestId?: String,\n      ?   AND?: ShareLinkWhereInput | ShareLinkWhereInput[],\n      ?   OR?: ShareLinkWhereInput[],\n      ?   NOT?: ShareLinkWhereInput | ShareLinkWhereInput[],\n      ?   vaultId?: StringFilter | String,\n      ?   createdById?: StringFilter | String,\n      ?   status?: EnumShareLinkStatusFilter | ShareLinkStatus,\n      ?   approvedById?: StringNullableFilter | String | Null,\n      ?   approvedAt?: DateTimeNullableFilter | DateTime | Null,\n      ?   vendorLabel?: StringFilter | String,\n      ?   vendorEmail?: StringFilter | String,\n      ?   purposeNotes?: StringNullableFilter | String | Null,\n      ?   expiresAt?: DateTimeFilter | DateTime,\n      ?   revokedAt?: DateTimeNullableFilter | DateTime | Null,\n      ?   encryptedLskForVendor?: StringNullableFilter | String | Null,\n      ?   lskSalt?: StringNullableFilter | String | Null,\n      ?   lskNonce?: StringNullableFilter | String | Null,\n      ?   createdAt?: DateTimeFilter | DateTime,\n      ?   updatedAt?: DateTimeFilter | DateTime,\n      ?   vault?: VaultRelationFilter | VaultWhereInput,\n      ?   creator?: UserProfileRelationFilter | UserProfileWhereInput,\n      ?   approver?: UserProfileNullableRelationFilter | UserProfileWhereInput | Null,\n      ?   shareRequest?: ShareRequestNullableRelationFilter | ShareRequestWhereInput | Null,\n      ?   documents?: ShareLinkDocumentListRelationFilter,\n      ?   auditEvents?: AuditEventListRelationFilter,\n      ?   otpChallenges?: OtpChallengeListRelationFilter\n        },\n        select: {\n          id: true,\n          vaultId: true,\n          vendorLabel: true,\n          purposeNotes: true,\n          status: true,\n          expiresAt: true,\n          revokedAt: true,\n          approvedAt: true,\n          createdAt: true,\n          encryptedLskForVendor: true,\n          lskSalt: true,\n          lskNonce: true\n        }\n      })\n\nArgument `where` of type ShareLinkWhereUniqueInput needs at least one of `id` or `shareRequestId` arguments. Available options are marked with ?.\n    at wn (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/@prisma+client@5.22.0_prisma@5.22.0/node_modules/@prisma/client/runtime/library.js:29:1363)\n    at $n.handleRequestError (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/@prisma+client@5.22.0_prisma@5.22.0/node_modules/@prisma/client/runtime/library.js:121:6958)\n    at $n.handleAndLogRequestError (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/@prisma+client@5.22.0_prisma@5.22.0/node_modules/@prisma/client/runtime/library.js:121:6623)\n    at $n.request (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/@prisma+client@5.22.0_prisma@5.22.0/node_modules/@prisma/client/runtime/library.js:121:6307)\n    at async l (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/@prisma+client@5.22.0_prisma@5.22.0/node_modules/@prisma/client/runtime/library.js:130:9633)\n    at async GET (/Users/fvivoli/opt/ubo-guard/webapp/.next/dev/server/chunks/[root-of-the-server]__c8938b7b._.js:163:27)\n    at async AppRouteRouteModule.do (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js:5:37866)\n    at async AppRouteRouteModule.handle (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js:5:45156)\n    at async responseGenerator (/Users/fvivoli/opt/ubo-guard/webapp/.next/dev/server/chunks/[root-of-the-server]__3a8594ea._.js:14849:38)\n    at async AppRouteRouteModule.handleResponse (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js:1:187713)\n    at async handleResponse (/Users/fvivoli/opt/ubo-guard/webapp/.next/dev/server/chunks/[root-of-the-server]__3a8594ea._.js:14912:32)\n    at async Module.handler (/Users/fvivoli/opt/ubo-guard/webapp/.next/dev/server/chunks/[root-of-the-server]__3a8594ea._.js:14965:13)\n    at async DevServer.renderToResponseWithComponentsImpl (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/base-server.js:1422:9)\n    at async DevServer.renderPageComponent (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/base-server.js:1474:24)\n    at async DevServer.renderToResponseImpl (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/base-server.js:1524:32)\n    at async DevServer.pipeImpl (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/base-server.js:1018:25)\n    at async NextNodeServer.handleCatchallRenderRequest (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/next-server.js:395:17)\n    at async DevServer.handleRequestImpl (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/base-server.js:909:17)\n    at async /Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/dev/next-dev-server.js:387:20\n    at async Span.traceAsyncFn (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/trace/trace.js:157:20)\n    at async DevServer.handleRequest (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/dev/next-dev-server.js:383:24)\n    at async invokeRender (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/lib/router-server.js:248:21)\n    at async handleRequest (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/lib/router-server.js:447:24)\n    at async requestHandlerImpl (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/lib/router-server.js:496:13)\n    at async Server.requestListener (/Users/fvivoli/opt/ubo-guard/webapp/node_modules/.pnpm/next@16.1.0_@babel+core@7.28.5_react-dom@19.2.3_react@19.2.3__react@19.2.3/node_modules/next/dist/server/lib/start-server.js:226:13)","errorName":"PrismaClientValidationError"},"timestamp":1767265580052,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"H"}
{"location":"v/[token]/page.tsx:48","message":"Vendor page - API error","data":{"token":"99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4","status":500,"statusText":"Internal Server Error"},"timestamp":1767265580098,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"D"}
{"location":"v/[token]/page.tsx:75","message":"Vendor page - error loading link info","data":{"token":"99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4","error":"Internal server error"},"timestamp":1767265580103,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"D"}
{"location":"v/[token]/page.tsx:34","message":"Vendor page - token received","data":{"token":"99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4","pathname":"/v/99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4"},"timestamp":1767265721417,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"B"}
{"location":"v/[token]/page.tsx:45","message":"Vendor page - fetching link info","data":{"token":"99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4","apiEndpoint":"/api/vendor/99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4/link-info"},"timestamp":1767265721422,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"D"}
{"location":"vendor/[token]/link-info/route.ts:10","message":"Vendor link-info - token received","data":{"token":"99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4","tokenLength":43},"timestamp":1767265721918,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"F"}
{"location":"vendor/[token]/link-info/route.ts:13","message":"Vendor link-info - token hash computed","data":{"token":"99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4","tokenHash":"270cff701edb2674b0c68b01f081ddd1d9b1a064fad595cddf948b51f9920dfd","tokenHashLength":64},"timestamp":1767265721918,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"F"}
{"location":"vendor/[token]/link-info/route.ts:32","message":"Vendor link-info - database lookup result","data":{"token":"99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4","tokenHash":"270cff701edb2674b0c68b01f081ddd1d9b1a064fad595cddf948b51f9920dfd","found":true,"shareLinkId":"ec8f0fa6-8515-498e-a6f5-a7ed671b09b9","status":"approved"},"timestamp":1767265722694,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"F"}
{"location":"v/[token]/page.tsx:65","message":"Vendor page - link info received","data":{"token":"99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4","status":"approved","hasVendorLabel":true,"hasEncryptedLsk":true},"timestamp":1767265722702,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"D"}
{"location":"v/[token]/page.tsx:72","message":"Vendor page - link status set","data":{"token":"99gsJQ9GJr1JGE68vi_WF-_bQjhjfMLgQQpVEj1Gzi4","linkStatus":"approved"},"timestamp":1767265722713,"sessionId":"debug-session","runId":"post-fix","hypothesisId":"D"}
{"location":"otp-form.tsx:30","message":"Before API call","data":{"tokenLength":43,"email":"t@t.com"},"timestamp":1767266178524,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"route.ts:13","message":"POST handler entry","data":{"hasParams":true},"timestamp":1767266179029,"sessionId":"debug-session","runId":"run1","hypothesisId":"E"}
{"location":"route.ts:17","message":"Resolving params","data":{},"timestamp":1767266179030,"sessionId":"debug-session","runId":"run1","hypothesisId":"E"}
{"location":"route.ts:20","message":"Params resolved","data":{"tokenLength":43},"timestamp":1767266179030,"sessionId":"debug-session","runId":"run1","hypothesisId":"E"}
{"location":"route.ts:23","message":"Request body parsed","data":{"hasEmail":true,"emailType":"string"},"timestamp":1767266179031,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"route.ts:30","message":"Email normalized","data":{"normalizedEmail":"t@t.com"},"timestamp":1767266179031,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"route.ts:33","message":"Before token hash","data":{"hasTokenHashPepper":true},"timestamp":1767266179031,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"route.ts:35","message":"Token hashed","data":{"tokenHashLength":64},"timestamp":1767266179031,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"route.ts:36","message":"Before shareLink query","data":{},"timestamp":1767266179031,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"route.ts:40","message":"ShareLink query result","data":{"found":true,"shareLinkId":"ec8f0fa6-8515-498e-a6f5-a7ed671b09b9","status":"approved"},"timestamp":1767266179330,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"route.ts:57","message":"Before OTP generation","data":{"hasOtpSecret":true,"hasOtpHmacSecret":false},"timestamp":1767266179330,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"route.ts:61","message":"OTP and salts generated","data":{"otpLength":6,"otpSaltLength":32,"emailSaltLength":32},"timestamp":1767266179331,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"route.ts:65","message":"Hashes computed","data":{"otpHashLength":64,"vendorEmailHashLength":64},"timestamp":1767266179332,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"route.ts:68","message":"Before OTP challenge create","data":{"shareLinkId":"ec8f0fa6-8515-498e-a6f5-a7ed671b09b9"},"timestamp":1767266179332,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"route.ts:79","message":"OTP challenge created","data":{},"timestamp":1767266179619,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"route.ts:82","message":"Before email send","data":{"hasMailtrapUsername":true,"hasMailtrapPassword":true,"appUrl":"http://localhost:3000"},"timestamp":1767266179620,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"route.ts:89","message":"Email sent successfully","data":{},"timestamp":1767266181071,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"route.ts:92","message":"Before audit log","data":{"vaultId":"4ea91cfe-dc7a-40ba-8a7c-988d2a635834"},"timestamp":1767266181073,"sessionId":"debug-session","runId":"run1","hypothesisId":"C"}
{"location":"route.ts:105","message":"Error caught","data":{"errorMessage":"\nInvalid `__TURBOPACK__imported__module__$5b$project$5d2f$opt$2f$ubo$2d$guard$2f$webapp$2f$src$2f$lib$2f$db$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__[\"prisma\"].auditEvent.create()` invocation in\n/Users/fvivoli/opt/ubo-guard/webapp/.next/dev/server/chunks/[root-of-the-server]__d9fedaa9._.js:232:190\n\n  229 const headersList = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$opt$2f$ubo$2d$guard$2f$webapp$2f$node_modules$2f2e$pnpm$2f$next$40$16$2e$1$2e$0_$40$babel$2b$core$40$7$2e$28$2e$5_react$2d$dom$40$19$2e$2$2e$3_react$40$19$2e$2$2e$3_$5f$react$40$19$2e$2$2e$3$2f$node_modules$2f$next$2f$headers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__[\"headers\"])();\n  230 const userAgent = headersList.get('user-agent') || undefined;\n  231 const ip = headersList.get('x-forwarded-for') || headersList.get('x-real-ip') || undefined;\n→ 232 await __TURBOPACK__imported__module__$5b$project$5d2f$opt$2f$ubo$2d$guard$2f$webapp$2f$src$2f$lib$2f$db$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__[\"prisma\"].auditEvent.create(\nForeign key constraint violated: `audit_events_actorId_fkey (index)`","errorStack":"PrismaClientKnownRequestError: \nInvalid `__TURBOPACK__imported__module__$5b$project$5d2f$opt$2f$ubo$2d$guard$2f$webapp$2f$src$2f$lib$2f$db$2f$prisma$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__[\"","errorName":"PrismaClientKnownRequestError"},"timestamp":1767266181430,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"otp-form.tsx:37","message":"Response received","data":{"status":500,"statusText":"Internal Server Error","ok":false},"timestamp":1767266181533,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"otp-form.tsx:40","message":"Response not ok","data":{"status":500,"error":"Internal server error"},"timestamp":1767266181543,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"otp-form.tsx:45","message":"Error in handleSendOtp","data":{"errorMessage":"Internal server error"},"timestamp":1767266181549,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"secret-form.tsx:23","message":"handleSubmit entry","data":{"vendorSecretLength":26,"encryptedLskLength":80,"lskSaltLength":24,"lskNonceLength":16},"timestamp":1767267810651,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"client-crypto.ts:169","message":"decryptLskWithVendorSecret entry","data":{"encryptedLskBase64Length":80,"lskSaltBase64Length":24,"lskNonceBase64Length":16,"vendorSecretLength":26},"timestamp":1767267810661,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"client-crypto.ts:177","message":"after vendor secret validation","data":{"normalizedVSLength":21,"vendorSecretBytesLength":13},"timestamp":1767267810666,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"client-crypto.ts:183","message":"after base64 decode","data":{"encryptedLskWithAuthTagLength":60,"lskSaltLength":16,"lskNonceLength":12},"timestamp":1767267810671,"sessionId":"debug-session","runId":"run1","hypothesisId":"C"}
{"location":"client-crypto.ts:189","message":"after extracting LSK components","data":{"encryptedLskLength":44,"lskAuthTagLength":16,"expectedEncryptedLskLength":32,"expectedAuthTagLength":16},"timestamp":1767267810675,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"vault-crypto.ts:390","message":"unwrapLskWithVendorSecret entry","data":{"encryptedDekLength":44,"nonceLength":12,"authTagLength":16,"vendorSecretBytesLength":13,"saltLength":16},"timestamp":1767267810680,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"vault-crypto.ts:396","message":"after wrap key derivation","data":{"wrapKeyExtractable":false,"wrapKeyAlgorithm":"AES-GCM"},"timestamp":1767267810686,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"vault-crypto.ts:401","message":"before decrypt call","data":{"encryptedWithTagLength":60,"nonceLength":12,"expectedNonceLength":12},"timestamp":1767267810691,"sessionId":"debug-session","runId":"run1","hypothesisId":"E"}
{"location":"vault-crypto.ts:417","message":"decrypt error","data":{"errorName":"OperationError","errorMessage":"The operation failed for an operation-specific reason","errorStack":""},"timestamp":1767267810695,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"secret-form.tsx:45","message":"decryptLskWithVendorSecret error","data":{"errorName":"OperationError","errorMessage":"The operation failed for an operation-specific reason","errorStack":""},"timestamp":1767267810699,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"secret-form.tsx:23","message":"handleSubmit entry","data":{"vendorSecretLength":26,"encryptedLskLength":80,"lskSaltLength":24,"lskNonceLength":16},"timestamp":1767267893488,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"client-crypto.ts:169","message":"decryptLskWithVendorSecret entry","data":{"encryptedLskBase64Length":80,"lskSaltBase64Length":24,"lskNonceBase64Length":16,"vendorSecretLength":26},"timestamp":1767267893500,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"client-crypto.ts:177","message":"after vendor secret validation","data":{"normalizedVSLength":21,"vendorSecretBytesLength":13},"timestamp":1767267893508,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"client-crypto.ts:183","message":"after base64 decode","data":{"encryptedLskWithMetadataLength":60,"lskSaltLength":16,"lskNonceSeparateLength":12},"timestamp":1767267893513,"sessionId":"debug-session","runId":"run1","hypothesisId":"C"}
{"location":"client-crypto.ts:189","message":"after extracting LSK components","data":{"encryptedLskLength":32,"lskAuthTagLength":16,"expectedEncryptedLskLength":32,"expectedAuthTagLength":16},"timestamp":1767267893517,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"vault-crypto.ts:390","message":"unwrapLskWithVendorSecret entry","data":{"encryptedDekLength":32,"nonceLength":12,"authTagLength":16,"vendorSecretBytesLength":13,"saltLength":16},"timestamp":1767267893521,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"vault-crypto.ts:396","message":"after wrap key derivation","data":{"wrapKeyExtractable":false,"wrapKeyAlgorithm":"AES-GCM"},"timestamp":1767267893526,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"vault-crypto.ts:401","message":"before decrypt call","data":{"encryptedWithTagLength":48,"nonceLength":12,"expectedNonceLength":12},"timestamp":1767267893530,"sessionId":"debug-session","runId":"run1","hypothesisId":"E"}
{"location":"vault-crypto.ts:417","message":"decrypt error","data":{"errorName":"OperationError","errorMessage":"The operation failed for an operation-specific reason","errorStack":""},"timestamp":1767267893534,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"secret-form.tsx:45","message":"decryptLskWithVendorSecret error","data":{"errorName":"OperationError","errorMessage":"The operation failed for an operation-specific reason","errorStack":""},"timestamp":1767267893537,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"secret-form.tsx:23","message":"handleSubmit entry","data":{"vendorSecretLength":26,"encryptedLskLength":80,"lskSaltLength":24,"lskNonceLength":16},"timestamp":1767267970093,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"client-crypto.ts:169","message":"decryptLskWithVendorSecret entry","data":{"encryptedLskBase64Length":80,"lskSaltBase64Length":24,"lskNonceBase64Length":16,"vendorSecretLength":26},"timestamp":1767267970104,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"client-crypto.ts:177","message":"after vendor secret validation","data":{"normalizedVSLength":21,"vendorSecretBytesLength":13},"timestamp":1767267970110,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"client-crypto.ts:183","message":"after base64 decode","data":{"encryptedLskWithMetadataLength":60,"lskSaltLength":16,"lskNonceSeparateLength":12},"timestamp":1767267970115,"sessionId":"debug-session","runId":"run1","hypothesisId":"C"}
{"location":"client-crypto.ts:189","message":"after extracting LSK components","data":{"encryptedLskLength":32,"lskAuthTagLength":16,"noncesMatch":true,"expectedEncryptedLskLength":32,"expectedAuthTagLength":16},"timestamp":1767267970119,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"vault-crypto.ts:390","message":"unwrapLskWithVendorSecret entry","data":{"encryptedDekLength":32,"nonceLength":12,"authTagLength":16,"vendorSecretBytesLength":13,"saltLength":16},"timestamp":1767267970123,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"vault-crypto.ts:396","message":"after wrap key derivation","data":{"wrapKeyExtractable":false,"wrapKeyAlgorithm":"AES-GCM"},"timestamp":1767267970128,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"vault-crypto.ts:401","message":"before decrypt call","data":{"encryptedWithTagLength":48,"nonceLength":12,"expectedNonceLength":12},"timestamp":1767267970132,"sessionId":"debug-session","runId":"run1","hypothesisId":"E"}
{"location":"vault-crypto.ts:417","message":"decrypt error","data":{"errorName":"OperationError","errorMessage":"The operation failed for an operation-specific reason","errorStack":""},"timestamp":1767267970136,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"secret-form.tsx:45","message":"decryptLskWithVendorSecret error","data":{"errorName":"OperationError","errorMessage":"The operation failed for an operation-specific reason","errorStack":""},"timestamp":1767267970141,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"secret-form.tsx:23","message":"handleSubmit entry","data":{"vendorSecretLength":26,"encryptedLskLength":80,"lskSaltLength":24,"lskNonceLength":16},"timestamp":1767268055753,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"client-crypto.ts:169","message":"decryptLskWithVendorSecret entry","data":{"encryptedLskBase64Length":80,"lskSaltBase64Length":24,"lskNonceBase64Length":16,"vendorSecretLength":26},"timestamp":1767268055759,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"client-crypto.ts:177","message":"after vendor secret validation","data":{"normalizedVSLength":21,"vendorSecretBytesLength":13,"normalizedVS":"3CSM2DQKS2JG6NH8WMTYE","vendorSecretBytesFirst4":[27,51,65,54]},"timestamp":1767268055764,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"client-crypto.ts:183","message":"after base64 decode","data":{"encryptedLskWithMetadataLength":60,"lskSaltLength":16,"lskNonceSeparateLength":12,"lskSaltFirst4Bytes":[234,72,86,33]},"timestamp":1767268055768,"sessionId":"debug-session","runId":"run1","hypothesisId":"C"}
{"location":"client-crypto.ts:189","message":"after extracting LSK components","data":{"encryptedLskLength":32,"lskAuthTagLength":16,"noncesMatch":true,"usingNonceFromBlob":true,"expectedEncryptedLskLength":32,"expectedAuthTagLength":16},"timestamp":1767268055772,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"vault-crypto.ts:390","message":"unwrapLskWithVendorSecret entry","data":{"encryptedDekLength":32,"nonceLength":12,"authTagLength":16,"vendorSecretBytesLength":13,"saltLength":16},"timestamp":1767268055775,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"vault-crypto.ts:358","message":"deriveWrapKeyFromVendorSecret entry","data":{"vendorSecretBytesLength":13,"saltLength":16,"saltFirst4Bytes":[234,72,86,33],"vendorSecretFirst4Bytes":[27,51,65,54]},"timestamp":1767268055779,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"vault-crypto.ts:375","message":"before HKDF deriveKey","data":{"infoString":"lsk-wrap","infoLength":8},"timestamp":1767268055782,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"vault-crypto.ts:390","message":"after HKDF deriveKey","data":{"wrapKeyExtractable":false,"wrapKeyAlgorithm":"AES-GCM"},"timestamp":1767268055786,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"vault-crypto.ts:396","message":"after wrap key derivation","data":{"wrapKeyExtractable":false,"wrapKeyAlgorithm":"AES-GCM"},"timestamp":1767268055789,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"vault-crypto.ts:401","message":"before decrypt call","data":{"encryptedWithTagLength":48,"nonceLength":12,"expectedNonceLength":12},"timestamp":1767268055793,"sessionId":"debug-session","runId":"run1","hypothesisId":"E"}
{"location":"vault-crypto.ts:417","message":"decrypt error","data":{"errorName":"OperationError","errorMessage":"The operation failed for an operation-specific reason","errorStack":""},"timestamp":1767268055796,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"secret-form.tsx:45","message":"decryptLskWithVendorSecret error","data":{"errorName":"OperationError","errorMessage":"The operation failed for an operation-specific reason","errorStack":""},"timestamp":1767268055800,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"secret-form.tsx:23","message":"handleSubmit entry","data":{"vendorSecret":"3CSM-2DQK-S2JG-6NH8-WMTY-E","vendorSecretLength":26,"encryptedLskLength":80,"lskSaltLength":24,"lskNonceLength":16},"timestamp":1767268155551,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"client-crypto.ts:169","message":"decryptLskWithVendorSecret entry","data":{"encryptedLskBase64Length":80,"lskSaltBase64Length":24,"lskNonceBase64Length":16,"vendorSecretLength":26},"timestamp":1767268155562,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"client-crypto.ts:177","message":"after vendor secret validation","data":{"normalizedVSLength":21,"vendorSecretBytesLength":13,"normalizedVS":"3CSM2DQKS2JG6NH8WMTYE","vendorSecretBytesFirst4":[27,51,65,54]},"timestamp":1767268155569,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"client-crypto.ts:183","message":"after base64 decode","data":{"encryptedLskWithMetadataLength":60,"lskSaltLength":16,"lskNonceSeparateLength":12,"lskSaltFirst4Bytes":[234,72,86,33]},"timestamp":1767268155575,"sessionId":"debug-session","runId":"run1","hypothesisId":"C"}
{"location":"client-crypto.ts:189","message":"after extracting LSK components","data":{"encryptedLskLength":32,"lskAuthTagLength":16,"noncesMatch":true,"usingNonceFromBlob":true,"expectedEncryptedLskLength":32,"expectedAuthTagLength":16},"timestamp":1767268155579,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"vault-crypto.ts:390","message":"unwrapLskWithVendorSecret entry","data":{"encryptedDekLength":32,"nonceLength":12,"authTagLength":16,"vendorSecretBytesLength":13,"saltLength":16},"timestamp":1767268155583,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"vault-crypto.ts:358","message":"deriveWrapKeyFromVendorSecret entry","data":{"vendorSecretBytesLength":13,"saltLength":16,"saltFirst4Bytes":[234,72,86,33],"vendorSecretFirst4Bytes":[27,51,65,54]},"timestamp":1767268155588,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"vault-crypto.ts:375","message":"before HKDF deriveKey","data":{"infoString":"lsk-wrap","infoLength":8},"timestamp":1767268155592,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"vault-crypto.ts:390","message":"after HKDF deriveKey","data":{"wrapKeyExtractable":false,"wrapKeyAlgorithm":"AES-GCM"},"timestamp":1767268155596,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"vault-crypto.ts:396","message":"after wrap key derivation","data":{"wrapKeyExtractable":false,"wrapKeyAlgorithm":"AES-GCM"},"timestamp":1767268155600,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"vault-crypto.ts:401","message":"before decrypt call","data":{"encryptedWithTagLength":48,"nonceLength":12,"expectedNonceLength":12},"timestamp":1767268155603,"sessionId":"debug-session","runId":"run1","hypothesisId":"E"}
{"location":"vault-crypto.ts:417","message":"decrypt error","data":{"errorName":"OperationError","errorMessage":"The operation failed for an operation-specific reason","errorStack":""},"timestamp":1767268155607,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"secret-form.tsx:45","message":"decryptLskWithVendorSecret error","data":{"errorName":"OperationError","errorMessage":"The operation failed for an operation-specific reason","errorStack":""},"timestamp":1767268155611,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"share-requests/[id]/page.tsx:170","message":"vendor secret generated during approval","data":{"vs":"20T8-Y9G0-W9K6-YGNT-JARG-T","vsBytesLength":12,"vsBytesFirst4":[16,52,143,38]},"timestamp":1767268279386,"sessionId":"debug-session","runId":"run1","hypothesisId":"G"}
{"location":"vault-crypto.ts:358","message":"deriveWrapKeyFromVendorSecret entry","data":{"vendorSecretBytesLength":12,"saltLength":16,"saltFirst4Bytes":[44,92,143,226],"vendorSecretFirst4Bytes":[16,52,143,38]},"timestamp":1767268279387,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"vault-crypto.ts:390","message":"after HKDF deriveKey","data":{"wrapKeyExtractable":false,"wrapKeyAlgorithm":"AES-GCM"},"timestamp":1767268279387,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"vault-crypto.ts:375","message":"before HKDF deriveKey","data":{"infoString":"lsk-wrap","infoLength":8},"timestamp":1767268279387,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"secret-form.tsx:23","message":"handleSubmit entry","data":{"vendorSecret":"20T8-Y9G0-W9K6-YGNT-JARG-T","vendorSecretLength":26,"encryptedLskLength":80,"lskSaltLength":24,"lskNonceLength":16},"timestamp":1767268315113,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"client-crypto.ts:169","message":"decryptLskWithVendorSecret entry","data":{"encryptedLskBase64Length":80,"lskSaltBase64Length":24,"lskNonceBase64Length":16,"vendorSecretLength":26},"timestamp":1767268315125,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"client-crypto.ts:177","message":"after vendor secret validation","data":{"normalizedVSLength":21,"vendorSecretBytesLength":12,"normalizedVS":"20T8Y9G0W9K6YGNTJARGT","vendorSecretBytesFirst4":[16,52,143,38]},"timestamp":1767268315132,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"client-crypto.ts:183","message":"after base64 decode","data":{"encryptedLskWithMetadataLength":60,"lskSaltLength":16,"lskNonceSeparateLength":12,"lskSaltFirst4Bytes":[44,92,143,226]},"timestamp":1767268315137,"sessionId":"debug-session","runId":"run1","hypothesisId":"C"}
{"location":"client-crypto.ts:189","message":"after extracting LSK components","data":{"encryptedLskLength":32,"lskAuthTagLength":16,"noncesMatch":true,"usingNonceFromBlob":true,"expectedEncryptedLskLength":32,"expectedAuthTagLength":16},"timestamp":1767268315141,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"vault-crypto.ts:390","message":"unwrapLskWithVendorSecret entry","data":{"encryptedDekLength":32,"nonceLength":12,"authTagLength":16,"vendorSecretBytesLength":12,"saltLength":16},"timestamp":1767268315145,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"vault-crypto.ts:358","message":"deriveWrapKeyFromVendorSecret entry","data":{"vendorSecretBytesLength":12,"saltLength":16,"saltFirst4Bytes":[44,92,143,226],"vendorSecretFirst4Bytes":[16,52,143,38]},"timestamp":1767268315149,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"vault-crypto.ts:375","message":"before HKDF deriveKey","data":{"infoString":"lsk-wrap","infoLength":8},"timestamp":1767268315153,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"vault-crypto.ts:390","message":"after HKDF deriveKey","data":{"wrapKeyExtractable":false,"wrapKeyAlgorithm":"AES-GCM"},"timestamp":1767268315157,"sessionId":"debug-session","runId":"run1","hypothesisId":"F"}
{"location":"vault-crypto.ts:396","message":"after wrap key derivation","data":{"wrapKeyExtractable":false,"wrapKeyAlgorithm":"AES-GCM"},"timestamp":1767268315161,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"vault-crypto.ts:401","message":"before decrypt call","data":{"encryptedWithTagLength":48,"nonceLength":12,"expectedNonceLength":12},"timestamp":1767268315164,"sessionId":"debug-session","runId":"run1","hypothesisId":"E"}
{"location":"vault-crypto.ts:414","message":"decrypt success","data":{"lskLength":32},"timestamp":1767268315168,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"secret-form.tsx:43","message":"decryptLskWithVendorSecret success","data":{"lskLength":32},"timestamp":1767268315171,"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"location":"otp/verify/route.ts:118","message":"Creating vendor session","data":{"shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","vendorEmailHash":"b11276f83ea83e9e8bb176cb90590cdf5bf3a3cffc7fc7868b881c58c1b1eb20","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268511899,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"vendor-session.ts:78","message":"Setting cookie","data":{"cookieName":"vendor_session","hasPayload":true,"payloadLength":265,"shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","expiresAt":1767270311903,"userAgentHash":"8561b369e292de8e"},"timestamp":1767268511910,"sessionId":"debug-session","runId":"run1","hypothesisId":"D,E"}
{"location":"vendor-session.ts:86","message":"Cookie set complete","data":{"cookieName":"vendor_session","isProduction":false,"sameSite":"lax","maxAge":1800,"path":"/"},"timestamp":1767268511911,"sessionId":"debug-session","runId":"run1","hypothesisId":"D,E"}
{"location":"otp/verify/route.ts:120","message":"Vendor session created","data":{"shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c"},"timestamp":1767268511912,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"documents/route.ts:52","message":"Before session validation","data":{"token":"TwOLw2gD-C7RnpssjY_R1gRchr1V_cJ6KpMLDqE5FKA","shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268518929,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B,C"}
{"location":"vendor-session.ts:92","message":"validateVendorSession entry","data":{"hasSessionSecret":true,"userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268518929,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"vendor-session.ts:99","message":"Cookie check","data":{"cookieExists":true,"hasValue":true,"cookieName":"vendor_session"},"timestamp":1767268518930,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"vendor-session.ts:133","message":"Session validation error","data":{"error":"Input buffers must have the same byte length"},"timestamp":1767268518930,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"documents/route.ts:55","message":"After session validation","data":{"sessionExists":false,"expectedShareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","match":false},"timestamp":1767268518930,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B,C"}
{"location":"documents/route.ts:58","message":"Session is null - returning 401","data":{"token":"TwOLw2gD-C7RnpssjY_R1gRchr1V_cJ6KpMLDqE5FKA","shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c"},"timestamp":1767268518930,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"documents/route.ts:52","message":"Before session validation","data":{"token":"TwOLw2gD-C7RnpssjY_R1gRchr1V_cJ6KpMLDqE5FKA","shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268519415,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B,C"}
{"location":"vendor-session.ts:92","message":"validateVendorSession entry","data":{"hasSessionSecret":true,"userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268519416,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"vendor-session.ts:99","message":"Cookie check","data":{"cookieExists":true,"hasValue":true,"cookieName":"vendor_session"},"timestamp":1767268519419,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"vendor-session.ts:133","message":"Session validation error","data":{"error":"Input buffers must have the same byte length"},"timestamp":1767268519420,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"documents/route.ts:55","message":"After session validation","data":{"sessionExists":false,"expectedShareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","match":false},"timestamp":1767268519421,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B,C"}
{"location":"documents/route.ts:58","message":"Session is null - returning 401","data":{"token":"TwOLw2gD-C7RnpssjY_R1gRchr1V_cJ6KpMLDqE5FKA","shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c"},"timestamp":1767268519421,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"otp/verify/route.ts:118","message":"Creating vendor session","data":{"shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","vendorEmailHash":"54e6eaa83912ca266d612b412ee381ca011e002c365f99aaee32a5667efbf9b6","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268571285,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"vendor-session.ts:78","message":"Setting cookie","data":{"cookieName":"vendor_session","hasPayload":true,"payloadLength":265,"shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","expiresAt":1767270371287,"userAgentHash":"8561b369e292de8e"},"timestamp":1767268571290,"sessionId":"debug-session","runId":"run1","hypothesisId":"D,E"}
{"location":"vendor-session.ts:86","message":"Cookie set complete","data":{"cookieName":"vendor_session","isProduction":false,"sameSite":"lax","maxAge":1800,"path":"/"},"timestamp":1767268571291,"sessionId":"debug-session","runId":"run1","hypothesisId":"D,E"}
{"location":"otp/verify/route.ts:120","message":"Vendor session created","data":{"shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c"},"timestamp":1767268571292,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"documents/route.ts:52","message":"Before session validation","data":{"token":"TwOLw2gD-C7RnpssjY_R1gRchr1V_cJ6KpMLDqE5FKA","shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268579325,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B,C"}
{"location":"vendor-session.ts:92","message":"validateVendorSession entry","data":{"hasSessionSecret":true,"userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268579325,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"vendor-session.ts:99","message":"Cookie check","data":{"cookieExists":true,"hasValue":true,"cookieName":"vendor_session"},"timestamp":1767268579327,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"vendor-session.ts:133","message":"Session validation error","data":{"error":"Input buffers must have the same byte length"},"timestamp":1767268579327,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"documents/route.ts:55","message":"After session validation","data":{"sessionExists":false,"expectedShareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","match":false},"timestamp":1767268579328,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B,C"}
{"location":"documents/route.ts:58","message":"Session is null - returning 401","data":{"token":"TwOLw2gD-C7RnpssjY_R1gRchr1V_cJ6KpMLDqE5FKA","shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c"},"timestamp":1767268579328,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"documents/route.ts:52","message":"Before session validation","data":{"token":"TwOLw2gD-C7RnpssjY_R1gRchr1V_cJ6KpMLDqE5FKA","shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268579480,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B,C"}
{"location":"vendor-session.ts:92","message":"validateVendorSession entry","data":{"hasSessionSecret":true,"userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268579481,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"vendor-session.ts:99","message":"Cookie check","data":{"cookieExists":true,"hasValue":true,"cookieName":"vendor_session"},"timestamp":1767268579483,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"vendor-session.ts:133","message":"Session validation error","data":{"error":"Input buffers must have the same byte length"},"timestamp":1767268579483,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"documents/route.ts:55","message":"After session validation","data":{"sessionExists":false,"expectedShareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","match":false},"timestamp":1767268579484,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B,C"}
{"location":"documents/route.ts:58","message":"Session is null - returning 401","data":{"token":"TwOLw2gD-C7RnpssjY_R1gRchr1V_cJ6KpMLDqE5FKA","shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c"},"timestamp":1767268579484,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"otp/verify/route.ts:118","message":"Creating vendor session","data":{"shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","vendorEmailHash":"0d8820d84f890f305dcbf5c23e9d0cdcd4a43a2b6eefe6ff108802a637741d2c","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268643882,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"vendor-session.ts:78","message":"Setting cookie","data":{"cookieName":"vendor_session","hasPayload":true,"payloadLength":265,"shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","expiresAt":1767270443886,"userAgentHash":"8561b369e292de8e"},"timestamp":1767268643889,"sessionId":"debug-session","runId":"run1","hypothesisId":"D,E"}
{"location":"vendor-session.ts:86","message":"Cookie set complete","data":{"cookieName":"vendor_session","isProduction":false,"sameSite":"lax","maxAge":1800,"path":"/"},"timestamp":1767268643890,"sessionId":"debug-session","runId":"run1","hypothesisId":"D,E"}
{"location":"otp/verify/route.ts:120","message":"Vendor session created","data":{"shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c"},"timestamp":1767268643892,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"documents/route.ts:52","message":"Before session validation","data":{"token":"TwOLw2gD-C7RnpssjY_R1gRchr1V_cJ6KpMLDqE5FKA","shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268652760,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B,C"}
{"location":"vendor-session.ts:92","message":"validateVendorSession entry","data":{"hasSessionSecret":true,"userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268652763,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"vendor-session.ts:99","message":"Cookie check","data":{"cookieExists":true,"hasValue":true,"cookieName":"vendor_session"},"timestamp":1767268652767,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"vendor-session.ts:132","message":"Before signature verification","data":{"signatureLength":56,"expectedSignatureLength":64,"signatureHex":"\"4cc7456d-7551-43ac-...","expectedSignatureHex":"138c7cc8c4d254af3de9..."},"timestamp":1767268652768,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"vendor-session.ts:145","message":"Buffer lengths","data":{"signatureBufferLength":0,"expectedSignatureBufferLength":32},"timestamp":1767268652769,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"vendor-session.ts:133","message":"Session validation error","data":{"error":"Input buffers must have the same byte length"},"timestamp":1767268652769,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"documents/route.ts:55","message":"After session validation","data":{"sessionExists":false,"expectedShareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","match":false},"timestamp":1767268652771,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B,C"}
{"location":"documents/route.ts:58","message":"Session is null - returning 401","data":{"token":"TwOLw2gD-C7RnpssjY_R1gRchr1V_cJ6KpMLDqE5FKA","shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c"},"timestamp":1767268652771,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"documents/route.ts:52","message":"Before session validation","data":{"token":"TwOLw2gD-C7RnpssjY_R1gRchr1V_cJ6KpMLDqE5FKA","shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268652790,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B,C"}
{"location":"vendor-session.ts:92","message":"validateVendorSession entry","data":{"hasSessionSecret":true,"userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268652791,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"vendor-session.ts:99","message":"Cookie check","data":{"cookieExists":true,"hasValue":true,"cookieName":"vendor_session"},"timestamp":1767268652793,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"vendor-session.ts:132","message":"Before signature verification","data":{"signatureLength":56,"expectedSignatureLength":64,"signatureHex":"\"4cc7456d-7551-43ac-...","expectedSignatureHex":"138c7cc8c4d254af3de9..."},"timestamp":1767268652794,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"vendor-session.ts:145","message":"Buffer lengths","data":{"signatureBufferLength":0,"expectedSignatureBufferLength":32},"timestamp":1767268652794,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"vendor-session.ts:133","message":"Session validation error","data":{"error":"Input buffers must have the same byte length"},"timestamp":1767268652795,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"documents/route.ts:55","message":"After session validation","data":{"sessionExists":false,"expectedShareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","match":false},"timestamp":1767268652795,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B,C"}
{"location":"documents/route.ts:58","message":"Session is null - returning 401","data":{"token":"TwOLw2gD-C7RnpssjY_R1gRchr1V_cJ6KpMLDqE5FKA","shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c"},"timestamp":1767268652795,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"otp/verify/route.ts:118","message":"Creating vendor session","data":{"shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","vendorEmailHash":"651bf1bc9daa6431b5d7c63978688010b8610922bcd54c73200f27c8dfd31f9f","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268731745,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"vendor-session.ts:78","message":"Setting cookie","data":{"cookieName":"vendor_session","hasPayload":true,"payloadLength":265,"shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","expiresAt":1767270531750,"userAgentHash":"8561b369e292de8e"},"timestamp":1767268731753,"sessionId":"debug-session","runId":"run1","hypothesisId":"D,E"}
{"location":"vendor-session.ts:86","message":"Cookie set complete","data":{"cookieName":"vendor_session","isProduction":false,"sameSite":"lax","maxAge":1800,"path":"/"},"timestamp":1767268731755,"sessionId":"debug-session","runId":"run1","hypothesisId":"D,E"}
{"location":"otp/verify/route.ts:120","message":"Vendor session created","data":{"shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c"},"timestamp":1767268731757,"sessionId":"debug-session","runId":"run1","hypothesisId":"D"}
{"location":"documents/route.ts:52","message":"Before session validation","data":{"token":"TwOLw2gD-C7RnpssjY_R1gRchr1V_cJ6KpMLDqE5FKA","shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268740502,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B,C"}
{"location":"vendor-session.ts:92","message":"validateVendorSession entry","data":{"hasSessionSecret":true,"userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268740505,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"vendor-session.ts:99","message":"Cookie check","data":{"cookieExists":true,"hasValue":true,"cookieName":"vendor_session"},"timestamp":1767268740508,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"vendor-session.ts:132","message":"Before signature verification","data":{"signatureLength":64,"expectedSignatureLength":64,"signatureHex":"a8a5d7797d0b58e0adb1...","expectedSignatureHex":"a8a5d7797d0b58e0adb1..."},"timestamp":1767268740509,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"vendor-session.ts:145","message":"Buffer lengths","data":{"signatureBufferLength":32,"expectedSignatureBufferLength":32},"timestamp":1767268740510,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"vendor-session.ts:148","message":"Signature verification result","data":{"signatureValid":true},"timestamp":1767268740510,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"vendor-session.ts:118","message":"Session parsed","data":{"shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","expiresAt":1767270531750,"now":1767268740511,"isExpired":false},"timestamp":1767268740511,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"vendor-session.ts:127","message":"User-agent verification","data":{"userAgentMatch":true,"sessionUserAgentHash":"8561b369e292de8e","expectedUserAgentHash":"8561b369e292de8e","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268740511,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"vendor-session.ts:131","message":"Session validation successful","data":{"shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c"},"timestamp":1767268740512,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"documents/route.ts:55","message":"After session validation","data":{"sessionExists":true,"sessionShareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","expectedShareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","match":true},"timestamp":1767268740513,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B,C"}
{"location":"documents/route.ts:52","message":"Before session validation","data":{"token":"TwOLw2gD-C7RnpssjY_R1gRchr1V_cJ6KpMLDqE5FKA","shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268740544,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B,C"}
{"location":"vendor-session.ts:92","message":"validateVendorSession entry","data":{"hasSessionSecret":true,"userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268740545,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"vendor-session.ts:99","message":"Cookie check","data":{"cookieExists":true,"hasValue":true,"cookieName":"vendor_session"},"timestamp":1767268740546,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"vendor-session.ts:132","message":"Before signature verification","data":{"signatureLength":64,"expectedSignatureLength":64,"signatureHex":"a8a5d7797d0b58e0adb1...","expectedSignatureHex":"a8a5d7797d0b58e0adb1..."},"timestamp":1767268740547,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"vendor-session.ts:145","message":"Buffer lengths","data":{"signatureBufferLength":32,"expectedSignatureBufferLength":32},"timestamp":1767268740547,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"vendor-session.ts:148","message":"Signature verification result","data":{"signatureValid":true},"timestamp":1767268740547,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"vendor-session.ts:118","message":"Session parsed","data":{"shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","expiresAt":1767270531750,"now":1767268740548,"isExpired":false},"timestamp":1767268740548,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"vendor-session.ts:127","message":"User-agent verification","data":{"userAgentMatch":true,"sessionUserAgentHash":"8561b369e292de8e","expectedUserAgentHash":"8561b369e292de8e","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15"},"timestamp":1767268740548,"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"location":"vendor-session.ts:131","message":"Session validation successful","data":{"shareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c"},"timestamp":1767268740548,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B"}
{"location":"documents/route.ts:55","message":"After session validation","data":{"sessionExists":true,"sessionShareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","expectedShareLinkId":"4cc7456d-7551-43ac-b192-fa3030b2301c","match":true},"timestamp":1767268740549,"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B,C"}
